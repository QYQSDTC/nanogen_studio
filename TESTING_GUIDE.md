# 测试指南

## 快速验证修复

### 测试 1: 基本文本生成（Pro 模型）

1. 选择模型：**Gemini 3 Pro Image Preview**
2. 设置参数：
   - 纵横比：1:1
   - 分辨率：1K
3. 提示词：`一只可爱的橘猫在阳光下睡觉`
4. 点击"生成图片"

**预期结果**：成功生成 1024×1024 的图片

### 测试 2: 高分辨率生成（Pro 模型）

1. 选择模型：**Gemini 3 Pro Image Preview**
2. 设置参数：
   - 纵横比：16:9
   - 分辨率：4K
3. 提示词：`未来主义城市，霓虹灯，赛博朋克风格，高清细节`
4. 点击"生成图片"

**预期结果**：成功生成 5504×3072 的高清图片

### 测试 3: 快速生成（Flash 模型）

1. 选择模型：**Gemini 2.5 Flash Image**
2. 设置参数：
   - 纵横比：1:1
   - 注意：分辨率选项应该被禁用（灰色）
3. 提示词：`一朵红色的玫瑰花`
4. 点击"生成图片"

**预期结果**：快速生成 1024×1024 的图片

### 测试 4: 参考图片生成

1. 选择模型：**Gemini 3 Pro Image Preview**
2. 上传一张参考图片
3. 设置参数：
   - 纵横比：4:3
   - 分辨率：2K
4. 提示词：`保持这个风格，但改成夜晚场景`
5. 点击"生成图片"

**预期结果**：生成风格相似的 2400×1792 图片

## 常见问题排查

### 问题 1: 仍然收到 "Unknown name" 错误

**可能原因**：
- 浏览器缓存了旧代码
- 未正确保存文件

**解决方案**：
1. 重新启动开发服务器：
   ```bash
   # Ctrl+C 停止服务器
   npm run dev
   ```
2. 清除浏览器缓存：
   - Chrome: Cmd+Shift+R (Mac) 或 Ctrl+Shift+R (Windows)
   - 或在开发者工具中勾选 "Disable cache"

### 问题 2: API Key 无效

**解决方案**：
1. 确认 API Key 正确复制（没有多余空格）
2. 在 [Google AI Studio](https://makersuite.google.com/app/apikey) 验证 API Key 状态
3. 确认已启用 Gemini API

### 问题 3: 图片生成失败

**检查项**：
- ✅ API Key 是否有效
- ✅ 网络连接是否正常
- ✅ 提示词是否符合内容政策
- ✅ 模型名称是否正确

### 问题 4: 分辨率选项不可用

**这是正常的！**
- Gemini 2.5 Flash 模型固定使用 1024px
- 只有 Gemini 3 Pro 模型支持多分辨率
- 切换到 Pro 模型即可使用分辨率选项

## API 请求示例

### 正确的请求格式（你可以在浏览器开发者工具的 Network 标签中验证）

```json
{
  "contents": [{
    "parts": [
      {
        "text": "一只可爱的猫"
      }
    ]
  }],
  "generationConfig": {
    "responseModalities": ["image"],
    "imageConfig": {
      "aspectRatio": "1:1",
      "imageSize": "2K"
    }
  }
}
```

### 验证方法

1. 打开浏览器开发者工具 (F12)
2. 切换到 **Network** 标签
3. 生成一张图片
4. 找到 `generateContent` 请求
5. 查看 **Payload** 或 **Request** 内容
6. 确认格式符合上述示例

## 性能基准

### Gemini 3 Pro Image Preview
- **1K 生成时间**: ~5-10 秒
- **2K 生成时间**: ~10-15 秒
- **4K 生成时间**: ~15-30 秒

### Gemini 2.5 Flash Image
- **生成时间**: ~2-5 秒
- **适合场景**: 快速预览、批量生成

## 成功标志

如果修复成功，你应该看到：

✅ 没有 "Unknown name" 错误  
✅ 图片成功生成  
✅ 生成的图片符合选择的纵横比  
✅ Pro 模型可以选择不同分辨率  
✅ Flash 模型快速生成（分辨率固定）  

## 报告问题

如果仍有问题，请提供以下信息：

1. **错误信息**：完整的错误消息
2. **浏览器**：浏览器类型和版本
3. **模型**：使用的模型名称
4. **参数**：纵横比和分辨率设置
5. **Network 请求**：从开发者工具复制的请求内容

---

**祝你使用愉快！** 🎨✨

